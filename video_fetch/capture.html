<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>10ì´ˆê°„ ì´¬ì˜</title>
  <style>
    video, canvas, img { display: block; margin: 10px auto; }
  </style>
</head>
<body>

  <h2 style="text-align: center;">10ì´ˆê°„ 0.1ì´ˆë§ˆë‹¤ ìº¡ì²˜</h2>
  <video id="video" width="480" height="360" autoplay muted></video>
  <canvas id="canvas" width="480" height="360" style="display: none;"></canvas>
  <div id="result" style="text-align: center;"></div>

  <script>
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const resultDiv = document.getElementById("result");
    const ctx = canvas.getContext("2d");

    let captureInterval;
    let captureCount = 0;
    const maxCaptures = 100; // 100ë²ˆ = 10ì´ˆê°„

    async function startCamera() {
      const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
    }

    function captureFrame() {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      // canvas â†’ Blob â†’ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° (ë˜ëŠ” ì„œë²„ ì „ì†¡ ê°€ëŠ¥)
      canvas.toBlob((blob) => {
        const img = document.createElement("img");
        img.src = URL.createObjectURL(blob);
        img.width = 120;
        resultDiv.appendChild(img);

        // ğŸ”½ ì„œë²„ ì „ì†¡ ì˜ˆì‹œ (ì˜µì…˜)
        /*
        const formData = new FormData();
        formData.append("image", blob, `frame_${captureCount}.webp`);
        fetch("/upload", { method: "POST", body: formData });
        */
      }, "image/webp");

      captureCount++;
      if (captureCount >= maxCaptures) {
        clearInterval(captureInterval);
        console.log("ì´¬ì˜ ì™„ë£Œ");
      }
    }

    async function startCapture() {
      await startCamera();

      setTimeout(() => {
        captureInterval = setInterval(captureFrame, 100); // 0.1ì´ˆë§ˆë‹¤ ìº¡ì²˜
      }, 1000); // 1ì´ˆ ëŒ€ê¸° í›„ ì‹œì‘ (ìº  ì¤€ë¹„ ì‹œê°„)
    }

    // ì‹¤í–‰
    startCapture();
  </script>

</body>
</html>
